{% extends "base.html" %}

{% block title %}Home - {{ config.BUSINESS_NAME }}{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section bg-gradient py-5" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <div class="container py-5">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1 class="display-4 fw-bold text-white mb-3">Premium 3D Printed Products</h1>
                <p class="lead text-white-50 mb-4">Discover custom-designed, high-quality 3D printed items crafted with precision and care.</p>
                <div class="d-flex gap-3">
                    <a href="{{ url_for('products') }}" class="btn btn-success btn-lg">Shop Now</a>
                    <a href="{{ url_for('contact') }}" class="btn btn-outline-light btn-lg">Custom Order</a>
                </div>
            </div>
            <div class="col-lg-6 text-center">
                <img src="{{ url_for('static', filename='images/hero-3d-icon.svg') }}" alt="3D Printing" class="img-fluid" style="max-width: 400px;">
            </div>
        </div>
    </div>
</section>

<!-- Stats Bar -->
<section class="stats-bar bg-dark text-white py-4">
    <div class="container">
        <div class="row text-center">
            <div class="col-md-4 mb-3 mb-md-0">
                <h3 class="display-6 fw-bold">{{ products_count|default(0, true) }}+</h3>
                <p class="text-muted mb-0">Products in Stock</p>
            </div>
            <div class="col-md-4 mb-3 mb-md-0">
                <h3 class="display-6 fw-bold">{{ happy_customers|default(0, true) }}+</h3>
                <p class="text-muted mb-0">Happy Customers</p>
            </div>
            <div class="col-md-4">
                <h3 class="display-6 fw-bold">üìç</h3>
                <p class="text-muted mb-0">Made in Pune, India</p>
            </div>
        </div>
    </div>
</section>

<!-- Featured Products Section -->
<section class="featured-products py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold mb-2">Featured Products</h2>
            <p class="text-muted">Hand-picked selection of our best-selling items</p>
        </div>
        <div class="row g-4">
            {% for product in featured_products %}
            <div class="col-6 col-md-4 col-lg-3">
                <div class="card h-100 product-card shadow-sm hover-shadow transition">
                    <!-- Product Image -->
                    <div class="product-image-wrapper position-relative overflow-hidden bg-white" style="height: 250px;">
                        {% if product.image_main %}
                            <img src="{{ url_for('static', filename='uploads/' + product.image_main) }}"
                                 alt="{{ product.name }}"
                                 class="card-img-top h-100 object-fit-cover"
                                 loading="lazy">
                        {% else %}
                            <div class="bg-secondary d-flex align-items-center justify-content-center h-100">
                                <span class="text-white">No Image</span>
                            </div>
                        {% endif %}

                        <!-- Category Badge -->
                        <span class="position-absolute top-0 start-0 badge bg-primary m-2">{{ product.category }}</span>

                        <!-- Discount Badge -->
                        {% if product.original_price and product.original_price > product.price %}
                            {% set discount_percent = ((product.original_price - product.price) / product.original_price * 100)|int %}
                            <span class="position-absolute top-0 end-0 badge bg-danger m-2">-{{ discount_percent }}%</span>
                        {% endif %}
                    </div>

                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title text-truncate">{{ product.name }}</h5>

                        <!-- Price Display -->
                        <div class="mb-3">
                            {% if product.original_price and product.original_price > product.price %}
                                <span class="text-decoration-line-through text-muted small">‚Çπ{{ product.original_price }}</span>
                                <br>
                                <span class="fw-bold text-danger display-6">‚Çπ{{ product.price }}</span>
                            {% else %}
                                <span class="fw-bold text-success display-6">‚Çπ{{ product.price }}</span>
                            {% endif %}
                        </div>

                        <!-- Stock Status & Buttons -->
                        <div class="mt-auto">
                            {% if product.stock_status == 'in_stock' %}
                                <form action="{{ url_for('cart_add') }}" method="POST" class="mb-2">
                                    <input type="hidden" name="product_id" value="{{ product.id }}">
                                    <button type="submit" class="btn btn-success btn-sm w-100">Add to Cart</button>
                                </form>
                            {% else %}
                                <button class="btn btn-secondary btn-sm w-100" disabled>Out of Stock</button>
                            {% endif %}
                            <a href="{{ url_for('product_detail', slug=product.slug) }}" class="btn btn-outline-primary btn-sm w-100">View Details</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- All Products Section -->
<section class="all-products py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold mb-2">All Products</h2>
            <p class="text-muted">Browse our complete collection</p>
        </div>

        <!-- Category Filter Buttons -->
        <div class="filter-buttons mb-4 text-center">
            <button class="btn btn-outline-primary me-2 mb-2 category-filter active" onclick="filterProducts('all')" data-filter="all">All</button>
            {% for category in categories %}
                <button class="btn btn-outline-primary me-2 mb-2 category-filter" onclick="filterProducts('{{ category }}')" data-filter="{{ category }}">{{ category|capitalize }}</button>
            {% endfor %}
        </div>

        <!-- Products Grid -->
        <div class="row g-4" id="productsGrid">
            {% for product in all_products %}
            <div class="col-6 col-md-4 col-lg-3 product-item" data-category="{{ product.category }}">
                <div class="card h-100 product-card shadow-sm hover-shadow transition">
                    <!-- Product Image -->
                    <div class="product-image-wrapper position-relative overflow-hidden bg-white" style="height: 250px;">
                        {% if product.image_main %}
                            <img src="{{ url_for('static', filename='uploads/' + product.image_main) }}"
                                 alt="{{ product.name }}"
                                 class="card-img-top h-100 object-fit-cover"
                                 loading="lazy">
                        {% else %}
                            <div class="bg-secondary d-flex align-items-center justify-content-center h-100">
                                <span class="text-white">No Image</span>
                            </div>
                        {% endif %}

                        <!-- Category Badge -->
                        <span class="position-absolute top-0 start-0 badge bg-primary m-2">{{ product.category }}</span>

                        <!-- Discount Badge -->
                        {% if product.original_price and product.original_price > product.price %}
                            {% set discount_percent = ((product.original_price - product.price) / product.original_price * 100)|int %}
                            <span class="position-absolute top-0 end-0 badge bg-danger m-2">-{{ discount_percent }}%</span>
                        {% endif %}
                    </div>

                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title text-truncate">{{ product.name }}</h5>

                        <!-- Price Display -->
                        <div class="mb-3">
                            {% if product.original_price and product.original_price > product.price %}
                                <span class="text-decoration-line-through text-muted small">‚Çπ{{ product.original_price }}</span>
                                <br>
                                <span class="fw-bold text-danger display-6">‚Çπ{{ product.price }}</span>
                            {% else %}
                                <span class="fw-bold text-success display-6">‚Çπ{{ product.price }}</span>
                            {% endif %}
                        </div>

                        <!-- Stock Status & Buttons -->
                        <div class="mt-auto">
                            {% if product.stock_status == 'in_stock' %}
                                <form action="{{ url_for('cart_add') }}" method="POST" class="mb-2">
                                    <input type="hidden" name="product_id" value="{{ product.id }}">
                                    <button type="submit" class="btn btn-success btn-sm w-100">Add to Cart</button>
                                </form>
                            {% else %}
                                <button class="btn btn-secondary btn-sm w-100" disabled>Out of Stock</button>
                            {% endif %}
                            <a href="{{ url_for('product_detail', slug=product.slug) }}" class="btn btn-outline-primary btn-sm w-100">View Details</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Category Showcase Section -->
<section class="category-showcase py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold mb-2">Shop by Category</h2>
            <p class="text-muted">Explore our diverse product categories</p>
        </div>
        <div class="row g-4">
            {% set category_icons = {
                'figurines': 'üé®',
                'miniatures': 'üè∞',
                'home-decor': 'üè†',
                'accessories': '‚ú®',
                'toys': 'üéÆ',
                'jewelry': 'üíç',
                'mechanical': '‚öôÔ∏è',
                'other': 'üì¶'
            } %}

            {% for category in categories %}
            <div class="col-md-6 col-lg-4">
                <a href="{{ url_for('products') }}?category={{ category }}" class="text-decoration-none">
                    <div class="category-card p-4 bg-white rounded-3 shadow-sm text-center hover-shadow transition">
                        <div class="display-4 mb-3">{{ category_icons.get(category, 'üì¶') }}</div>
                        <h4 class="mb-2">{{ category|capitalize }}</h4>
                        <p class="text-muted small mb-0">Explore products</p>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Why Choose Us Section -->
<section class="why-choose-us py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold mb-2">Why Choose Us</h2>
            <p class="text-muted">What makes us different</p>
        </div>
        <div class="row g-4">
            <div class="col-md-6 col-lg-3">
                <div class="feature-card text-center p-4">
                    <div class="display-4 mb-3" style="color: #667eea;">üé®</div>
                    <h5 class="mb-2">Custom Designs</h5>
                    <p class="text-muted small">Bring your ideas to life with our custom design services. We work with you to create unique products.</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="feature-card text-center p-4">
                    <div class="display-4 mb-3" style="color: #764ba2;">‚≠ê</div>
                    <h5 class="mb-2">Quality Materials</h5>
                    <p class="text-muted small">We use premium-grade materials to ensure durability and excellent finish on every product.</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="feature-card text-center p-4">
                    <div class="display-4 mb-3" style="color: #198754;">‚ö°</div>
                    <h5 class="mb-2">Fast Delivery</h5>
                    <p class="text-muted small">Quick turnaround time without compromising on quality. Get your orders delivered on time.</p>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="feature-card text-center p-4">
                    <div class="display-4 mb-3" style="color: #ffc107;">üí∞</div>
                    <h5 class="mb-2">Affordable Prices</h5>
                    <p class="text-muted small">Premium quality at competitive prices. We believe great products should be accessible to everyone.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Newsletter CTA Section -->
<section class="newsletter-cta py-5 bg-gradient" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center text-white">
                <h2 class="display-5 fw-bold mb-3">Stay Updated</h2>
                <p class="lead mb-4">Subscribe to our newsletter for exclusive offers, new product launches, and design inspiration.</p>
                <form class="d-flex gap-2" method="POST" action="{{ url_for('contact') }}">
                    <input type="email" class="form-control form-control-lg" placeholder="Enter your email" required>
                    <button type="submit" class="btn btn-light btn-lg fw-bold">Subscribe</button>
                </form>
                <small class="text-white-50 d-block mt-3">We respect your privacy. Unsubscribe anytime.</small>
            </div>
        </div>
    </div>
</section>

<!-- Business Info Section -->
<section class="business-info py-4 bg-light border-top">
    <div class="container text-center text-muted small">
        <p class="mb-2"><strong>{{ config.BUSINESS_NAME }}</strong></p>
        <p class="mb-2">üìç {{ config.BUSINESS_ADDRESS }}</p>
        <p class="mb-0">üì± <a href="https://wa.me/{{ config.WHATSAPP_NUMBER }}" class="text-decoration-none text-muted">WhatsApp: {{ config.WHATSAPP_NUMBER }}</a></p>
    </div>
</section>

{% endblock %}

{% block extra_css %}
<style>
    .hover-shadow {
        transition: box-shadow 0.3s ease;
    }

    .hover-shadow:hover {
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
    }

    .product-card {
        border: none;
    }

    .product-image-wrapper {
        overflow: hidden;
    }

    .object-fit-cover {
        object-fit: cover;
    }

    .transition {
        transition: all 0.3s ease;
    }

    .category-filter.active {
        background-color: #667eea;
        color: white;
        border-color: #667eea !important;
    }

    .feature-card {
        border-radius: 15px;
        border: 1px solid #e9ecef;
        transition: transform 0.3s ease;
    }

    .feature-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1);
    }

    .hero-section {
        min-height: 500px;
        display: flex;
        align-items: center;
    }

    .bg-gradient {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .stats-bar {
        position: relative;
        top: -50px;
        z-index: 1;
        margin-bottom: -50px;
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
    function filterProducts(category) {
        // Update active button
        document.querySelectorAll('.category-filter').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.classList.add('active');

        // Filter products
        const products = document.querySelectorAll('.product-item');
        products.forEach(product => {
            if (category === 'all' || product.getAttribute('data-category') === category) {
                product.style.display = '';
            } else {
                product.style.display = 'none';
            }
        });
    }
</script>
{% endblock %}
